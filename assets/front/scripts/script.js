var h=Object.defineProperty;var u=(i,t,e)=>t in i?h(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var r=(i,t,e)=>u(i,typeof t!="symbol"?t+"":t,e);const c=async i=>{try{const t=await fetch(i);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return{success:!0,data:await t.json()}}catch(t){return{success:!1,error:t.message}}},p=(i,t)=>i.replace(new RegExp(t,"gi"),e=>`<b style="color: red;">${e}</b>`),l={resultItem:(i,t)=>`
  <div class="wp-search-item"><a target="_blank" href="${i.link}">${p(i.title.rendered,t??"")}</a></div>
`,message:i=>`
<div class="wp-search-message">${i}</div>
`},o={startSearching:"Please enter a search term.",noResults:"No results found.",searching:"Searching..."};class m{constructor(t){r(this,"selectors",{root:"[data-livesearch]",button:"[data-livesearch-button]",input:"[data-livesearch-input]",container:"[data-livesearch-container]",wrapper:"[data-livesearch-wrapper]"});r(this,"attributes",{ariaExpanded:"aria-expanded"});r(this,"stateClasses",{isActive:"is-active"});r(this,"options",{siteName:window.location.host,postTypes:[],showItems:6,excludeKeyWords:""});r(this,"rootElement");r(this,"wrapperElement");r(this,"buttonElement");r(this,"inputElement");r(this,"containerElement");r(this,"timeout",null);r(this,"searchDelay",500);r(this,"state");r(this,"onClickOutside",t=>{var e,s;this.isNotSearchRelated(t)&&((e=this.wrapperElement)==null||e.classList.remove(this.stateClasses.isActive),(s=this.buttonElement)==null||s.setAttribute(this.attributes.ariaExpanded,"false"))});r(this,"toggleSearch",()=>{var e,s,n,a;if(!this.wrapperElement)return;const t=(e=this.wrapperElement)==null?void 0:e.classList.contains(this.stateClasses.isActive);(s=this.wrapperElement)==null||s.classList.toggle(this.stateClasses.isActive,!t),(n=this.buttonElement)==null||n.setAttribute(this.attributes.ariaExpanded,(!t).toString()),(a=this.inputElement)==null||a.focus()});r(this,"onInput",()=>{var t;if(((t=this.inputElement)==null?void 0:t.value)===""){this.state.results=[],this.showMessage(o.startSearching);return}this.showMessage(o.searching),this.timeout&&clearTimeout(this.timeout),this.timeout=window.setTimeout(()=>{this.getData()},this.searchDelay)});var e,s,n,a;this.rootElement=document.querySelector(this.selectors.root),this.buttonElement=((e=this.rootElement)==null?void 0:e.querySelector(this.selectors.button))||null,this.inputElement=((s=this.rootElement)==null?void 0:s.querySelector(this.selectors.input))||null,this.containerElement=((n=this.rootElement)==null?void 0:n.querySelector(this.selectors.container))||null,this.wrapperElement=((a=this.rootElement)==null?void 0:a.querySelector(this.selectors.wrapper))||null,this.options={...this.options,...t},this.state=this.getResultsProxy({results:[]}),this.isReady&&this.bindEvents()}bindEvents(){var t,e;(t=this.inputElement)==null||t.addEventListener("input",this.onInput),(e=this.buttonElement)==null||e.addEventListener("click",this.toggleSearch),document.documentElement.addEventListener("click",this.onClickOutside)}isNotSearchRelated(t){var e,s;return!((e=this.wrapperElement)!=null&&e.contains(t.target))&&!((s=this.buttonElement)!=null&&s.contains(t.target))}isReady(){return!!(this.rootElement&&this.inputElement&&this.buttonElement&&this.containerElement&&this.wrapperElement)}getResultsProxy(t){return new Proxy(t,{get:(e,s)=>e[s],set:(e,s,n)=>(e[s]=n,this.updateUI(),!0)})}showMessage(t){this.containerElement&&(this.containerElement.innerHTML=l.message(t))}filterResults(){let t=this.state.results;return t=this.filterByTitle(t),t=this.filterByExcludeWords(t),t.slice(0,this.options.showItems)}stringToArray(t){return t.split(",").map(e=>e.trim())}filterByTitle(t){return t.filter(e=>{var s;return e.title.rendered.toLowerCase().includes((((s=this.inputElement)==null?void 0:s.value)??"").toLowerCase())})}filterByExcludeWords(t){var s;const e=(s=this.options.excludeKeyWords)==null?void 0:s.trim();return e?t.filter(n=>!this.stringToArray(e).some(a=>n.title.rendered.toLowerCase().includes(a.toLowerCase()))):t}updateUI(){const t=this.filterResults();if(t.length>0){const e=t.map(s=>{var n;return l.resultItem(s,((n=this.inputElement)==null?void 0:n.value)??"")}).join("");this.containerElement&&(this.containerElement.innerHTML=e)}else this.showMessage(o.noResults)}async getData(){const t=this.options.postTypes.map(s=>this.getPostTypeData(s)),e=await Promise.all(t);this.state.results=e.flat()}async getPostTypeData(t){var n;const e=new URL(`/wp-json/wp/v2/${t}/`,`https://${this.options.siteName}`);(n=this.inputElement)!=null&&n.value&&e.searchParams.set("search",this.inputElement.value);const s=await c(e.toString());return s.success?s.data:[]}}document.addEventListener("DOMContentLoaded",()=>{(async()=>{const t=await c(`${ajax_obj==null?void 0:ajax_obj.ajax_url}?action=get_search_data`);if(t.success){const e=t.data;new m({siteName:e.site_name,postTypes:e.post_types_to_search,showItems:e.show_results,excludeKeyWords:e.exclude_key_words})}else{console.error(t.error);return}})()});
