var c=Object.defineProperty;var h=(n,t,e)=>t in n?c(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var i=(n,t,e)=>h(n,typeof t!="symbol"?t+"":t,e);const l=async n=>{try{const t=await fetch(n);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return{success:!0,data:await t.json()}}catch(t){return{success:!1,error:t.message}}},u=(n,t)=>n.replace(new RegExp(t,"gi"),e=>`<b style="color: red;">${e}</b>`),o={resultItem:(n,t)=>`
  <div class="wp-search-item"><a target="_blank" href="${n.link}">${u(n.title.rendered,t??"")}</a></div>
`,message:n=>`
<div class="wp-search-message">${n}</div>
`};class p{constructor(t){i(this,"selectors",{root:"[data-livesearch]",button:"[data-livesearch-button]",input:"[data-livesearch-input]",container:"[data-livesearch-container]",wrapper:"[data-livesearch-wrapper]"});i(this,"attributes",{ariaExpanded:"aria-expanded"});i(this,"stateClasses",{isActive:"is-active"});i(this,"messages",{startSearching:"Please enter a search term.",noResults:"No results found.",searching:"Searching..."});i(this,"options",{siteName:window.location.host,postTypes:[],showItems:6});i(this,"rootElement");i(this,"wrapperElement");i(this,"buttonElement");i(this,"inputElement");i(this,"containerElement");i(this,"state");i(this,"onButtonClick",()=>{var t,e,s,r;(t=this.wrapperElement)==null||t.classList.toggle(this.stateClasses.isActive),(s=this.buttonElement)==null||s.setAttribute(this.attributes.ariaExpanded,(e=this.wrapperElement)!=null&&e.classList.contains(this.stateClasses.isActive)?"true":"false"),(r=this.inputElement)==null||r.focus()});i(this,"onInput",()=>{var t;if(((t=this.inputElement)==null?void 0:t.value)===""){this.state.results=[],this.showMessage(this.messages.startSearching);return}this.getData()});var e,s,r,a;this.rootElement=document.querySelector(this.selectors.root),this.buttonElement=((e=this.rootElement)==null?void 0:e.querySelector(this.selectors.button))||null,this.inputElement=((s=this.rootElement)==null?void 0:s.querySelector(this.selectors.input))||null,this.containerElement=((r=this.rootElement)==null?void 0:r.querySelector(this.selectors.container))||null,this.wrapperElement=((a=this.rootElement)==null?void 0:a.querySelector(this.selectors.wrapper))||null,this.options={...this.options,...t},this.state=this.getResultsProxy({results:[]}),this.bindEvents()}bindEvents(){var t,e;(t=this.inputElement)==null||t.addEventListener("input",this.onInput),(e=this.buttonElement)==null||e.addEventListener("click",this.onButtonClick)}getResultsProxy(t){return new Proxy(t,{get:(e,s)=>e[s],set:(e,s,r)=>(e[s]=r,this.updateUI(),!0)})}showMessage(t){this.containerElement&&(this.containerElement.innerHTML=o.message(t))}filterResults(){return this.state.results.filter(e=>{var s;return e.title.rendered.toLowerCase().includes((((s=this.inputElement)==null?void 0:s.value)??"").toLowerCase())}).slice(0,this.options.showItems)}updateUI(){const t=this.filterResults();if(t.length>0){const e=t.map(s=>{var r;return o.resultItem(s,((r=this.inputElement)==null?void 0:r.value)??"")}).join("");this.containerElement&&(this.containerElement.innerHTML=e)}else this.showMessage(this.messages.noResults)}async getData(){this.showMessage(this.messages.searching);const t=this.options.postTypes.map(s=>this.getPostTypeData(s)),e=await Promise.all(t);this.state.results=e.flat()}async getPostTypeData(t){var s;const e=await l(`https://${this.options.siteName}/wp-json/wp/v2/${t}/?search=${(s=this.inputElement)==null?void 0:s.value}`);return e.success?e.data:[]}}document.addEventListener("DOMContentLoaded",()=>{(async()=>{const t=await l(`${ajax_obj.ajax_url}?action=get_search_data`);if(t.success){const e=t.data;new p({siteName:e.siteName,postTypes:e.postTypes,showItems:e.showItems})}else{console.error(t.error);return}})()});
