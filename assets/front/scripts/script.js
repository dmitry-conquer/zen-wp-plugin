var c=Object.defineProperty;var h=(r,t,e)=>t in r?c(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var n=(r,t,e)=>h(r,typeof t!="symbol"?t+"":t,e);const u=async r=>{try{const t=await fetch(r);if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return{success:!0,data:await t.json()}}catch(t){return{success:!1,error:t.message}}},p=(r,t)=>r.replace(new RegExp(t,"gi"),e=>`<b style="color: red;">${e}</b>`),l={resultItem:(r,t)=>`
  <div class="wp-search-item"><a target="_blank" href="${r.link}">${p(r.title.rendered,t??"")}</a></div>
`,message:r=>`
<div class="wp-search-message">${r}</div>
`},o={startSearching:"Please enter a search term.",noResults:"No results found.",searching:"Searching..."};class m{constructor(t){n(this,"selectors",{root:"[data-livesearch]",button:"[data-livesearch-button]",input:"[data-livesearch-input]",container:"[data-livesearch-container]",wrapper:"[data-livesearch-wrapper]"});n(this,"attributes",{ariaExpanded:"aria-expanded"});n(this,"stateClasses",{isActive:"is-active"});n(this,"options",{siteName:window.location.host,postTypes:[],showItems:6,excludeKeyWords:""});n(this,"rootElement");n(this,"wrapperElement");n(this,"buttonElement");n(this,"inputElement");n(this,"containerElement");n(this,"timeout",null);n(this,"searchDelay",500);n(this,"state");n(this,"onButtonClick",()=>{var t,e,s,i;(t=this.wrapperElement)==null||t.classList.toggle(this.stateClasses.isActive),(s=this.buttonElement)==null||s.setAttribute(this.attributes.ariaExpanded,(e=this.wrapperElement)!=null&&e.classList.contains(this.stateClasses.isActive)?"true":"false"),(i=this.inputElement)==null||i.focus()});n(this,"onInput",()=>{var t;if(((t=this.inputElement)==null?void 0:t.value)===""){this.state.results=[],this.showMessage(o.startSearching);return}this.showMessage(o.searching),this.timeout&&clearTimeout(this.timeout),this.timeout=window.setTimeout(()=>{this.getData()},this.searchDelay)});var e,s,i,a;this.rootElement=document.querySelector(this.selectors.root),this.buttonElement=((e=this.rootElement)==null?void 0:e.querySelector(this.selectors.button))||null,this.inputElement=((s=this.rootElement)==null?void 0:s.querySelector(this.selectors.input))||null,this.containerElement=((i=this.rootElement)==null?void 0:i.querySelector(this.selectors.container))||null,this.wrapperElement=((a=this.rootElement)==null?void 0:a.querySelector(this.selectors.wrapper))||null,this.options={...this.options,...t},this.state=this.getResultsProxy({results:[]}),this.isReady&&this.bindEvents()}bindEvents(){var t,e;(t=this.inputElement)==null||t.addEventListener("input",this.onInput),(e=this.buttonElement)==null||e.addEventListener("click",this.onButtonClick)}isReady(){return!!(this.rootElement&&this.inputElement&&this.buttonElement&&this.containerElement&&this.wrapperElement)}getResultsProxy(t){return new Proxy(t,{get:(e,s)=>e[s],set:(e,s,i)=>(e[s]=i,this.updateUI(),!0)})}showMessage(t){this.containerElement&&(this.containerElement.innerHTML=l.message(t))}filterResults(){let t=this.state.results;return t=this.filterByTitle(t),t=this.filterByExcludeWords(t),t.slice(0,this.options.showItems)}stringToArray(t){return t.split(",").map(e=>e.trim())}filterByTitle(t){return t.filter(e=>{var s;return e.title.rendered.toLowerCase().includes((((s=this.inputElement)==null?void 0:s.value)??"").toLowerCase())})}filterByExcludeWords(t){var s;const e=(s=this.options.excludeKeyWords)==null?void 0:s.trim();return e?t.filter(i=>!this.stringToArray(e).some(a=>i.title.rendered.toLowerCase().includes(a.toLowerCase()))):t}updateUI(){const t=this.filterResults();if(t.length>0){const e=t.map(s=>{var i;return l.resultItem(s,((i=this.inputElement)==null?void 0:i.value)??"")}).join("");this.containerElement&&(this.containerElement.innerHTML=e)}else this.showMessage(o.noResults)}async getData(){const t=this.options.postTypes.map(s=>this.getPostTypeData(s)),e=await Promise.all(t);this.state.results=e.flat()}async getPostTypeData(t){var i;const e=new URL(`/wp-json/wp/v2/${t}/`,`https://${this.options.siteName}`);(i=this.inputElement)!=null&&i.value&&e.searchParams.set("search",this.inputElement.value);const s=await u(e.toString());return s.success?s.data:[]}}document.addEventListener("DOMContentLoaded",()=>{(async()=>{const t=await u(`${ajax_obj==null?void 0:ajax_obj.ajax_url}?action=get_search_data`);if(t.success){const e=t.data;new m({siteName:e.site_name,postTypes:e.post_types_to_search,showItems:e.show_results,excludeKeyWords:e.exclude_key_words})}else{console.error(t.error);return}})()});
